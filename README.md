# Система мониторинга RTMP/RTSP потоков

## Описание проекта
Система для мониторинга и управления RTMP/RTSP потоками с веб-интерфейсом. Проект позволяет отслеживать состояние потоков, управлять трансляциями и визуализировать телеметрию дронов в реальном времени.

## Основные возможности
- Мониторинг RTMP/RTSP потоков в реальном времени
- Веб-интерфейс для управления потоками
- Симуляция телеметрии дронов
- Автоматическое восстановление потоков
- Поддержка различных источников (камера, экран, файл)
- Интеграция с MediaMTX для управления потоками
- Сохранение истории телеметрии в базе данных

## Технический стек
- FastAPI - веб-фреймворк
- MediaMTX - медиа-сервер
- SQLAlchemy - ORM для работы с базой данных
- FFmpeg - обработка медиа-потоков
- WebSocket - real-time обновления
- Jinja2 - шаблонизатор

## Установка и запуск

### Требования
- Python 3.8+
- MediaMTX
- FFmpeg
- SQLite

### Установка зависимостей
```bash
pip install -r requirements.txt
```

### Запуск приложения
```bash
python main.py
```

После запуска веб-интерфейс будет доступен по адресу: http://localhost:8000

## Структура проекта
```
├── main.py              # Основной файл приложения
├── mediamtx_manager.py  # Управление MediaMTX
├── stream_monitor.py    # Мониторинг потоков
├── drone_telemetry.py   # Симуляция телеметрии
├── db.py               # Работа с базой данных
├── web/
│   ├── api.py          # REST API
│   └── stream_monitor.py # Мониторинг потоков
├── templates/          # HTML шаблоны
└── static/            # Статические файлы
```

## API Endpoints

### Потоки
- `GET /api/streams` - список всех потоков
- `POST /api/streams` - создание нового потока
- `GET /api/streams/{stream_id}` - информация о потоке
- `DELETE /api/streams/{stream_id}` - удаление потока

### Телеметрия
- `GET /api/telemetry` - получение телеметрии всех дронов
- `GET /api/telemetry/{drone_id}` - телеметрия конкретного дрона
- `GET /api/telemetry/history/{drone_id}` - история телеметрии

## Конфигурация
Основные настройки находятся в файле `mediamtx.minimal.yml`:
- Порт RTMP: 1935
- Порт RTSP: 8554
- Порт API: 9997
- Порт HLS: 8888

## Безопасность
- Валидация входных данных
- Безопасное управление процессами
- Обработка ошибок на всех уровнях
- Защита от перегрузки системы

## Логирование
- Многоуровневое логирование
- Сохранение событий
- Отслеживание ошибок
- Мониторинг производительности

## Разработка
Для разработки рекомендуется использовать виртуальное окружение:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
```

